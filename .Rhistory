truncDP <- Fit(truncDP, 1, TRUE, TRUE)
plot(truncDP)
truncDP <- Fit(truncDP, 1, TRUE, TRUE)
plot(truncDP)
truncDP <- Fit(truncDP, 1, TRUE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
truncDP <- Fit(truncDP, 1, TRUE, TRUE)
plot(truncDP)
truncDP <- Fit(truncDP, 1, TRUE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
truncDP$clusterParameters
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = FALSE)
truncDP <- Fit(truncDP, 1, TRUE, TRUE)
plot(truncDP)
truncDP <- Fit(truncDP, 100, TRUE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
truncDP$clusterParameters
truncDP <- Fit(truncDP, 1000, TRUE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = FALSE)
truncDP <- Fit(truncDP, 100, TRUE, FALSE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncDP <- Fit(truncDP, 100, TRUE, FALSE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
truncDP$mixingDistribution$priorParameters
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncMD$priorParameters
truncDP <- Fit(truncDP, 1, TRUE, FALSE)
truncDP <- Fit(truncDP, 1, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
truncDP <- Fit(truncDP, 10, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncDP <- Fit(truncDP, 10, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncDP <- Fit(truncDP, 1000, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
60*60*24
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.001, 0.001), "nonconjugate", mhStepSize = c(1, 1)*15000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncMD <- MixingDistribution("trunc", priorParameters = c(0.001, 0.001), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.001, 0.001), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.001, 0.001), "nonconjugate", mhStepSize = c(1, 1)*10, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.001, 0.001), "nonconjugate", mhStepSize = c(1, 1)*10, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
1/rgamma(10, 0.001, 0.001)
1/rgamma(1000, 0.01, 0.01)
hist(1/rgamma(1000, 0.01, 0.01))
hist(1/rgamma(1000, 0.1, 0.1))
hist(1/rgamma(1000, 1, 1))
hist(1/rgamma(1000, 0.1, 0.1))
hist(1/rgamma(1000, 0.1, 1))
(1/rgamma(1000, 0.1, 1))
(1/rgamma(1000, 0.01, 1))
(1/rgamma(1000, 0.1, 1))
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*10, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(0.1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncDP <- Fit(truncDP, 100, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
truncMD <- MixingDistribution("trunc", priorParameters = c(1, 1), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
mleGuess <- optim(c(1,1), function(x) dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))$par
?dtruncnorm
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(1,1), function(x) sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
mleGuess <- optim(c(100,100), function(x) sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
dtruncnorm(yTrunc, 0, 60*60*24, 1,1)
dtruncnorm(yTrunc, 0, 60*60*24, 100,100)
dtruncnorm(yTrunc, 0, 60*60*24, 1000,1000)
log(dtruncnorm(yTrunc, 0, 60*60*24, 1000,1000))
sum(log(dtruncnorm(yTrunc, 0, 60*60*24, 1000,1000)))
mleGuess <- optim(c(10000,10000), function(x) sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
mleGuess$par
mleGuess$par
mleGuess
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
lines(density(rtruncnorm(10000, a=0, b=60*60*24, mleGuess[1], mleGuess[2])))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
lines(density(rtruncnorm(10000, a=0, b=60*60*24, mleGuess[1], mleGuess[2])), col='blue')
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
lines(density(rtruncnorm(10000, a=0, b=60*60*24, mleGuess[1], mleGuess[2])), col='blue')
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 7500), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncDP <- Fit(truncDP, 100, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
lines(density(rtruncnorm(10000, a=0, b=60*60*24, mleGuess[1], mleGuess[2])), col='blue')
truncDP <- Fit(truncDP, 1000, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
lines(density(rtruncnorm(10000, a=0, b=60*60*24, mleGuess[1], mleGuess[2])), col='blue')
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(truncDP)
truncDP$mixingDistribution$priorParameters
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*1, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
truncDP <- Fit(truncDP, 1000, FALSE, TRUE)
plot(truncDP)
plot(c(199*Likelihood(truncDP$mixingDistribution, yTrunc[1200], truncDP$clusterParameters),
0.2*Likelihood(truncDP$mixingDistribution, yTrunc[1200], PriorDraw(truncDP$mixingDistribution,3))))
plot(density(yTrunc, from=0, to=60*60*24))
lines(density(rtruncnorm(10000, a=0, b=60*60*24, PriorDraw(truncDP$mixingDistribution, 1)[[1]], PriorDraw(truncDP$mixingDistribution, 1)[[2]])), col="red")
lines(density(rtruncnorm(10000, a=0, b=60*60*24, mleGuess[1], mleGuess[2])), col='blue')
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*10, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*100, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*1000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*1000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
yTrunc <- c(rtruncnorm(100, 0, 60*60*24, 60*60*6, 7500), rtruncnorm(100, 0, 60*60*24, 60*60*18, 7500))
mleGuess <- optim(c(10000,10000), function(x) -1*sum(log(dtruncnorm(yTrunc, 0, 60*60*24, x[1], x[2]))))$par
truncMD <- MixingDistribution("trunc", priorParameters = c(2, 15000), "nonconjugate", mhStepSize = c(1, 1)*1000, hyperPriorParameters = c(1, 1/1000000))
truncDP <- DirichletProcessCreate(yTrunc, truncMD)
truncDP <- Initialise(truncDP, posterior = TRUE)
PosteriorDraw(truncMD, yTrunc, 10000)
pds <- PosteriorDraw(truncMD, yTrunc, 1000)
plot(c(pds[[1]]))
pds <- PosteriorDraw(truncMD, yTrunc, 100000)
plot(c(pds[[1]]))
100^(-0.5)
1000^(-0.5)
1^(-0.5)
0.5^(-0.5)
0.05^(-0.5)
rgamma(10, 0.1, 0.1)
rgamma(10, 0.01, 0.01)
rgamma(10, 1, 01)
rgamma(10, 1, 1)
rgamma(10, 1, 2)
rgamma(10, 1, 0.5)
rgamma(10, 2, 0.5)
rgamma(10, 2, 1)
(rgamma(10, 2, 1))^(-0.5)
(2*rgamma(10, 2, 1))^(-0.5)
(1*rgamma(10, 2, 1))^(-0.5)
(0.1*rgamma(10, 2, 1))^(-0.5)
rnorm(10, 0, 15)
(1*rgamma(10, 2, 1))^(-0.5)
(1*rgamma(10, 2, 2))^(-0.5)
rm(list=ls())
