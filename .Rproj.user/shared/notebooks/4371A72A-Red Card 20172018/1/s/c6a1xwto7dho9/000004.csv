"0","gamesRaw %>% select(Date, Div,  HR, AR, WHH, WHD, WHA, IWH, IWD, IWA, AwayTeam)  -> games"
"0","games %>% mutate(SendOff = (HR | AR)) %>% select(-HR, -AR) -> games"
"0","games %>% mutate(DayOfWeek=weekdays(Date), Month=month(Date), DayNum=day(Date), Year=year(Date), Week=week(Date)) -> games"
"0","games$SendOff <- factor(games$SendOff, labels=c(""No"", ""Yes""))"
"0","games %>% filter(!is.na(SendOff), !is.na(WHH), !is.na(IWH)) %>% select(-Date) -> games"
"0","dummies <- dummyVars(SendOff ~ ., data = games)"
"0","oddsTrans <- preProcess(select(games, WHH, WHD, WHA, IWH, IWD, IWA), method=c(""center"", ""scale"", ""pca""), thresh=0.99)"
"0","gamesDum <- as.data.frame(predict(dummies, newdata = games))"
"2","variable 'SendOff' is not a factor"
"0","gamesDum <- cbind(gamesDum, predict(oddsTrans, select(games, WHH, WHD, WHA, IWH, IWD, IWA)))"
"0","gamesDum %>% select(-WHH, -WHD, -WHA, -IWH, -IWD, -IWA) -> gamesDum"
"0","gamesDum$SendOff <- games$SendOff"
"0","gamesDunTrain <- filter(gamesDum, Year != 2017)"
"0","gamesDunTest <- filter(gamesDum, Year == 2017)"
"0","ctrl <- trainControl(method=""repeatedcv"", number=10, repeats=5, summaryFunction=twoClassSummary, classProbs=TRUE)"
"0","#glmnetgrid <- expand.grid(alpha=seq(0.35, 0.85, 0.05), lambda=seq(0.001, 0.01, length=11))"
"0","caretModel <- train(SendOff~., data=gamesDunTrain, method=""glmnet"", metric=""ROC"", trControl=ctrl)"
