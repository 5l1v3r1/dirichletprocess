"0","dpobjlist <- list(dpobj1, dpobj2)"
"0","global_parameter_update <- function(dpobjlist){"
"0","  "
"0","  theta_k <- dpobjlist[[1]]$mixing_distribution$theta_k"
"0","  global_labels <- unique(unlist(lapply(seq_along(dpobjlist), function(x) match(unlist(dpobjlist[[x]]$cluster_parameters), theta_k))))"
"0","  "
"0","  for(i in seq_along(global_labels)){"
"0","    "
"0","    param <- theta_k[global_labels[i]]"
"0","    "
"0","    pts <- list()"
"0","    "
"0","    for(k in seq_along(dpobjlist)){"
"0","      "
"0","      data_inds <- which(dpobjlist[[k]]$cluster_parameters[[1]] == param)"
"0","      "
"0","      pts[[k]] <- dpobjlist[[k]]$data[dpobjlist[[k]]$cluster_labels %in% data_inds, ]"
"0","    }"
"0","    "
"0","    total_pts <- matrix(unlist(pts), ncol=1)"
"0","    "
"0","    new_param <- posterior_draw(dpobjlist[[k]]$mixing_distribution, total_pts, 1)"
"0","    "
"0","    theta_k[global_labels[i]] <- new_param"
"0","    "
"0","    "
"0","    for(k in seq_along(dpobjlist)){"
"0","      dpobjlist[[k]]$cluster_parameters[[1]][,, dpobjlist[[k]]$cluster_parameters[[1]] == param] <- array(new_param, dim=c(1,1, length(dpobjlist[[k]]$cluster_parameters[[1]][,, dpobjlist[[k]]$cluster_parameters[[1]] == param])))"
"0","    }"
"0","    "
"0","    "
"0","    "
"0","  }"
"0","  "
"0","  for(k in seq_along(dpobjlist)){"
"0","    dpobjlist[[k]]$mixing_distribution$theta_k <- array(theta_k, dim = c(1,1,length(theta_k)))"
"0","  }"
"0","  "
"0","return(dpobjlist)"
"0","}"
"0","global_table_update <- function(dpobjlist){"
"0","  "
"0","  for(k in seq_along(dpobjlist)){"
"0","    dpobjlist[[k]] <- cluster_component_update(dpobjlist[[k]])"
"0","  }"
"0","  return(dpobjlist)"
"0","}"
